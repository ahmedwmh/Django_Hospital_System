{% extends "admin/change_list.html" %}
{% load i18n admin_urls static admin_list %}

{% block title %}{{ title }} | {% trans 'نظام إدارة المستشفى' %}{% endblock %}

{% block content %}
<!-- ADD NEW BUTTON -->
<div class="add-new-container" style="margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); border: 1px solid #e2e8f0;">
    <div>
        <h1 style="margin: 0; color: #1f2937; font-size: 1.875rem; font-weight: 700;">{{ title }}</h1>
        <p style="margin: 5px 0 0 0; color: #6b7280; font-size: 0.875rem;">إدارة {{ title|lower }}</p>
    </div>
    <div>
        <a href="{% url 'admin:'|add:opts.app_label|add:'_'|add:opts.model_name|add:'_add' %}" 
           class="add-new-btn" 
           style="display: inline-flex; align-items: center; gap: 8px; background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%); color: white; padding: 12px 20px; border-radius: 8px; text-decoration: none; font-weight: 600; font-size: 0.875rem; box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3); transition: all 0.2s ease; border: none; cursor: pointer;">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
            إضافة جديد
        </a>
    </div>
</div>

<script>
// Add hover effects to the Add New button
document.addEventListener('DOMContentLoaded', function() {
    const addNewBtn = document.querySelector('.add-new-btn');
    if (addNewBtn) {
        addNewBtn.addEventListener('mouseenter', function() {
            this.style.background = 'linear-gradient(135deg, #1d4ed8 0%, #1e40af 100%)';
            this.style.transform = 'translateY(-1px)';
            this.style.boxShadow = '0 6px 16px rgba(59, 130, 246, 0.4)';
        });
        
        addNewBtn.addEventListener('mouseleave', function() {
            this.style.background = 'linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)';
            this.style.transform = 'translateY(0)';
            this.style.boxShadow = '0 4px 12px rgba(59, 130, 246, 0.3)';
        });
        
        addNewBtn.addEventListener('mousedown', function() {
            this.style.transform = 'translateY(0)';
            this.style.boxShadow = '0 2px 8px rgba(59, 130, 246, 0.3)';
        });
        
        addNewBtn.addEventListener('mouseup', function() {
            this.style.transform = 'translateY(-1px)';
            this.style.boxShadow = '0 6px 16px rgba(59, 130, 246, 0.4)';
        });
    }
});
</script>
{{ block.super }}
{% endblock %}

{% block extrahead %}
{{ block.super }}
<style>
    /* UNIVERSAL CLEAN FLEXBOX LAYOUT - SIDEBAR & TABLE SIDE BY SIDE */
    
    /* Hide default Django filter */
    #changelist-filter {
        display: none !important;
    }
    
    /* Ensure action buttons are visible */
    .actions {
        display: block !important;
        visibility: visible !important;
        opacity: 1 !important;
    }
    
    .action-checkbox-column {
        display: table-cell !important;
        visibility: visible !important;
    }
    
    /* Ensure edit/delete links are visible */
    .changelink, .deletelink {
        display: inline-block !important;
        visibility: visible !important;
        opacity: 1 !important;
    }
    
    /* Main container - full height */
    #content-main {
        display: flex !important;
        flex-direction: row !important;
        width: 100% !important;
        height: 100% !important;
        gap: 20px !important;
        padding: 20px !important;
        box-sizing: border-box !important;
        margin: 0 !important;
    }
    
    /* Filter Sidebar - Fixed width */
    #content-related {
        display: flex !important;
        flex-direction: column !important;
        flex: 0 0 250px !important;
        width: 250px !important;
        min-width: 250px !important;
        max-width: 250px !important;
        background: #f8f9fa !important;
        border-radius: 8px !important;
        padding: 20px !important;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1) !important;
        border: 1px solid #e9ecef !important;
        position: sticky !important;
        top: 20px !important;
        max-height: calc(100vh - 40px) !important;
        overflow-y: auto !important;
        box-sizing: border-box !important;
    }
    
    /* Main Content Area - Flexible width */
    .main-content-area {
        display: flex !important;
        flex: 1 !important;
        flex-direction: column !important;
        min-width: 0 !important;
        width: auto !important;
        box-sizing: border-box !important;
    }
    
    /* Table Container - Full width within main content */
    .table-container {
        display: flex !important;
        flex: 1 !important;
        flex-direction: column !important;
        width: 100% !important;
        background: white !important;
        border-radius: 8px !important;
        overflow: hidden !important;
        box-shadow: 0 2px 4px rgba(0,0,0,0.05) !important;
        border: 1px solid #e2e8f0 !important;
        box-sizing: border-box !important;
    }
    
    /* Table - Full width */
    .results {
        display: flex !important;
        flex: 1 !important;
        flex-direction: column !important;
        width: 100% !important;
        overflow: auto !important;
    }
    
    .results table {
        width: 100% !important;
        border-collapse: collapse !important;
        margin: 0 !important;
        padding: 0 !important;
    }
    
    .results th,
    .results td {
        padding: 12px 16px !important;
        text-align: right !important;
        border-bottom: 1px solid #e2e8f0 !important;
        white-space: nowrap !important;
    }
    
    .results th {
        background: #f8fafc !important;
        font-weight: 600 !important;
        color: #374151 !important;
        position: sticky !important;
        top: 0 !important;
        z-index: 10 !important;
    }
    
    .results tr:nth-child(even) {
        background: #f9fafb !important;
    }
    
    .results tr:hover {
        background: #f3f4f6 !important;
    }
    
    /* Responsive Design */
    @media (max-width: 768px) {
        #content-main {
            flex-direction: column !important;
            gap: 15px !important;
            padding: 15px !important;
        }
        
        #content-related {
            flex: none !important;
            width: 100% !important;
            min-width: auto !important;
            max-width: none !important;
            position: static !important;
            max-height: none !important;
        }
        
        .main-content-area {
            flex: 1 !important;
            width: 100% !important;
        }
    }
    
    /* Override any conflicting styles */
    * {
        box-sizing: border-box !important;
    }
</style>
{% endblock %}


<script>
// Universal JavaScript - Clean flexbox layout
document.addEventListener('DOMContentLoaded', function() {
    
    // Ensure proper flexbox layout
    const contentMain = document.getElementById('content-main');
    if (contentMain) {
        contentMain.style.cssText = `
            display: flex !important;
            flex-direction: row !important;
            width: 100% !important;
            height: 100% !important;
            gap: 20px !important;
            padding: 20px !important;
            box-sizing: border-box !important;
            margin: 0 !important;
        `;
    }
    
    // Ensure sidebar is properly sized
    const sidebar = document.getElementById('content-related');
    if (sidebar) {
        sidebar.style.cssText = `
            display: flex !important;
            flex-direction: column !important;
            flex: 0 0 250px !important;
            width: 250px !important;
            min-width: 250px !important;
            max-width: 250px !important;
            background: #f8f9fa !important;
            border-radius: 8px !important;
            padding: 20px !important;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1) !important;
            border: 1px solid #e9ecef !important;
            position: sticky !important;
            top: 20px !important;
            max-height: calc(100vh - 40px) !important;
            overflow-y: auto !important;
            box-sizing: border-box !important;
        `;
    }
    
    // Ensure main content area is flexible
    const mainContent = document.querySelector('.main-content-area');
    if (mainContent) {
        mainContent.style.cssText = `
            display: flex !important;
            flex: 1 !important;
            flex-direction: column !important;
            min-width: 0 !important;
            width: auto !important;
            box-sizing: border-box !important;
        `;
    }
    
    // Ensure add new container is properly styled
    const addNewContainer = document.querySelector('.add-new-container');
    if (addNewContainer) {
        addNewContainer.style.cssText = `
            margin-bottom: 20px !important;
            display: flex !important;
            justify-content: space-between !important;
            align-items: center !important;
            flex-wrap: wrap !important;
            gap: 15px !important;
        `;
    }
    
    // Ensure table container takes full width
    const tableContainer = document.querySelector('.table-container');
    if (tableContainer) {
        tableContainer.style.cssText = `
            display: flex !important;
            flex: 1 !important;
            flex-direction: column !important;
            width: 100% !important;
            background: white !important;
            border-radius: 8px !important;
            overflow: hidden !important;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05) !important;
            border: 1px solid #e2e8f0 !important;
            box-sizing: border-box !important;
        `;
    }
    
    // Add "Add New" button functionality is now handled inline
});

</script>
